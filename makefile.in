# $Id: makefile.in,v 1.14 2000/07/27 23:16:56 tom Exp $
# template makefile for DIALOG
#
SHELL		= /bin/sh

VERSION		= `cat VERSION`

prefix		= @prefix@
exec_prefix	= @exec_prefix@

srcdir		= @srcdir@
top_builddir	= .

DESTDIR		=
bindir		= $(DESTDIR)@bindir@
libdir		= $(DESTDIR)@libdir@
mandir		= $(DESTDIR)@mandir@
MANDIR		= $(mandir)/man1

# see po/makefile
localedir       = $(prefix)/@DATADIRNAME@/locale

CFLAGS		= @CFLAGS@
CPPFLAGS	= @CPPFLAGS@ @DEFS@ -I. -I$(srcdir) -DLOCALEDIR=\"$(localedir)\" -DVERSION=\"$(VERSION)\"
EXTRA_CFLAGS	= @EXTRA_CFLAGS@
CC		= @CC@
LDFLAGS		= @LDFLAGS@
LIBS		= @LIBS@ @INTLDIR_MAKE@ @INTLLIBS@
RANLIB		= @RANLIB@

RM		= rm -f

INSTALL		= @INSTALL@
INSTALL_PROGRAM	= @INSTALL_PROGRAM@
INSTALL_DATA	= @INSTALL_DATA@

#
# Standard .c to .o compile line.
#
.c.o:
@RULE_CC@
	@ECHO_CC@$(CC) $(CFLAGS) $(EXTRA_CFLAGS) $(CPPFLAGS) -c $<

EXTRAOBJS = @EXTRAOBJS@
OBJS = $(EXTRAOBJS) \
	arrows.o \
	buttons.o \
	checklist.o \
	inputbox.o \
	inputstr.o \
	menubox.o \
	mousewget.o \
	msgbox.o \
	textbox.o \
	util.o \
	yesno.o

SRCS = $(OBJS:.o=.c)

LIB	= libdialog.a
PROG	= dialog
ALL	= $(LIB) $(PROG)

DIRS	= $(bindir) $(MANDIR)

all	:: $(ALL)

@INTLLIBS@:
	@echo "Building GNU gettext library..."
	@cd intl && $(MAKE) @cf_cv_makeflags@

dialog.o \
$(OBJS) : $(srcdir)/dialog.h config.h

$(LIB) : $(OBJS)
	ar crv $(LIB) $(OBJS)
	$(RANLIB) $@

dialog: $(LIB) dialog.o @INTLDIR_MAKE@ @INTLLIBS@
	$(CC) -o $@ dialog.o -L. -ldialog $(LDFLAGS) $(LIBS)

clean	::
@INTLDIR_MAKE@	@-test -f intl/Makefile && cd intl && $(MAKE) @cf_cv_makeflags@ $@
@MSG_DIR_MAKE@	@-test -f po/Makefile && cd po && $(MAKE) @cf_cv_makeflags@ $@
	rm -f core *.o *~ $(ALL)

distclean :: clean
@INTLDIR_MAKE@	@-test -f intl/Makefile && cd intl && $(MAKE) @cf_cv_makeflags@ $@
@MSG_DIR_MAKE@	@-test -f po/Makefile && cd po && $(MAKE) @cf_cv_makeflags@ $@
	rm -f intl/libintl.h intl/po2tbl.sed
	rm -f makefile config.h config.cache config.log config.status

install :: $(ALL) $(DIRS)
@INTLDIR_MAKE@	@-test -f intl/Makefile && cd intl && $(MAKE) @cf_cv_makeflags@ $@
@MSG_DIR_MAKE@	@-test -f po/Makefile && cd po && $(MAKE) @cf_cv_makeflags@ $@
	$(INSTALL_PROGRAM) -s $(PROG) $(bindir)
	$(INSTALL_DATA) dialog.1 $(MANDIR)

uninstall ::
@INTLDIR_MAKE@	@-test -f intl/Makefile && cd intl && $(MAKE) @cf_cv_makeflags@ $@
@MSG_DIR_MAKE@	@-test -f po/Makefile && cd po && $(MAKE) @cf_cv_makeflags@ $@
	rm -f $(bindir)/$(PROG)
	rm -f $(MANDIR)/dialog.1

$(bindir) \
$(MANDIR) : ; $(srcdir)/mkdirs.sh $@
